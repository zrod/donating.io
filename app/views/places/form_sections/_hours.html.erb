<fieldset class="card card-md card-border bg-white mb-6"
         data-controller="hours"
         data-hours-messages-value='<%= {
           select_days_instruction: I18n.t("views.places.form_sections.hours.js_messages.select_days_instruction"),
           selected_label: I18n.t("views.places.form_sections.hours.js_messages.selected_label"),
           select_days_error: I18n.t("views.places.form_sections.hours.js_messages.select_days_error"),
           invalid_time_range: I18n.t("views.places.form_sections.hours.js_messages.invalid_time_range"),
           no_hours_added: I18n.t("views.places.form_sections.hours.js_messages.no_hours_added")
         }.to_json %>'
         data-hours-day-names-value='<%= {
           "1" => I18n.t("views.places.form_sections.hours.days.monday"),
           "2" => I18n.t("views.places.form_sections.hours.days.tuesday"),
           "3" => I18n.t("views.places.form_sections.hours.days.wednesday"),
           "4" => I18n.t("views.places.form_sections.hours.days.thursday"),
           "5" => I18n.t("views.places.form_sections.hours.days.friday"),
           "6" => I18n.t("views.places.form_sections.hours.days.saturday"),
           "7" => I18n.t("views.places.form_sections.hours.days.sunday")
         }.to_json %>'
         data-hours-day-names-short-value='<%= {
           "1" => I18n.t("views.places.form_sections.hours.days_short.monday"),
           "2" => I18n.t("views.places.form_sections.hours.days_short.tuesday"),
           "3" => I18n.t("views.places.form_sections.hours.days_short.wednesday"),
           "4" => I18n.t("views.places.form_sections.hours.days_short.thursday"),
           "5" => I18n.t("views.places.form_sections.hours.days_short.friday"),
           "6" => I18n.t("views.places.form_sections.hours.days_short.saturday"),
           "7" => I18n.t("views.places.form_sections.hours.days_short.sunday")
         }.to_json %>'>
  <div class="card-body">
    <legend class="card-title text-2xl font-semibold">
      <%= I18n.t("views.places.form_sections.hours.title") %>
    </legend>
    <p class="text-sm text-base-content/60 mb-6">
      <%= I18n.t("views.places.form_sections.optional") %>
    </p>

    <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
      <div>
        <h3 class="font-semibold text-lg mb-3">
          <%= I18n.t("views.places.form_sections.hours.week_days") %>
        </h3>
        <div class="border border-base-300 rounded-lg p-2" style="min-height: 200px;">
          <% [
              [I18n.t("views.places.form_sections.hours.days.sunday"), 7, 'sunday'],
              [I18n.t("views.places.form_sections.hours.days.monday"), 1, 'monday'],
              [I18n.t("views.places.form_sections.hours.days.tuesday"), 2, 'tuesday'],
              [I18n.t("views.places.form_sections.hours.days.wednesday"), 3, 'wednesday'],
              [I18n.t("views.places.form_sections.hours.days.thursday"), 4, 'thursday'],
              [I18n.t("views.places.form_sections.hours.days.friday"), 5, 'friday'],
              [I18n.t("views.places.form_sections.hours.days.saturday"), 6, 'saturday']
            ].each do |day_short, day_num, day_key| %>
            <div class="day-selector p-2 rounded cursor-pointer transition-all duration-200 select-none"
                data-day="<%= day_num %>"
                data-hours-target="daySelector"
                data-action="click->hours#toggleDay">
              <%= day_short %>
           </div>
          <% end %>
        </div>
        <div data-hours-target="selectionInfo" class="text-sm text-base-content/60 mt-2">
          <%= I18n.t("views.places.form_sections.hours.select_days_instruction") %>
        </div>
      </div>

      <div class="lg:col-span-2">
        <div class="grid grid-cols-2 gap-4 mb-4">
          <div>
            <h3 class="font-semibold text-lg mb-3">
              <%= I18n.t("views.places.form_sections.hours.from") %>
            </h3>
            <select data-hours-target="fromTime" class="select select-bordered w-full">
              <% (0..23).each do |hour| %>
                <% [0, 30].each do |minute| %>
                  <% time_24 = sprintf("%02d%02d", hour, minute) %>
                  <% time_12 = Time.parse("#{hour}:#{minute}").strftime("%l:%M %P").strip %>
                  <option value="<%= time_24 %>"><%= time_12 %></option>
                <% end %>
              <% end %>
            </select>
          </div>

          <div>
            <h3 class="font-semibold text-lg mb-3">
              <%= I18n.t("views.places.form_sections.hours.to") %>
            </h3>
            <select data-hours-target="toTime" class="select select-bordered w-full">
              <% (0..23).each do |hour| %>
                <% [0, 30].each do |minute| %>
                  <% time_24 = sprintf("%02d%02d", hour, minute) %>
                  <% time_12 = Time.parse("#{hour}:#{minute}").strftime("%l:%M %P").strip %>
                  <option value="<%= time_24 %>"><%= time_12 %></option>
                <% end %>
              <% end %>
            </select>
          </div>
        </div>

        <button type="button" class="btn btn-primary w-full mb-4" data-action="click->hours#includeSelectedHours">
          <%= I18n.t("views.places.form_sections.hours.include_selected") %>
        </button>
      </div>

      <div>
        <h3 class="font-semibold text-lg mb-3">
          <%= I18n.t("views.places.form_sections.hours.presets") %>
        </h3>
        <div class="space-y-2">
          <button type="button" class="btn btn-outline w-full text-left justify-start" data-preset="24hours" data-action="click->hours#applyPreset">
            <%= I18n.t("views.places.form_sections.hours.preset_24_hours") %>
          </button>
          <button type="button" class="btn btn-outline w-full text-left justify-start" data-preset="working" data-action="click->hours#applyPreset">
            <%= I18n.t("views.places.form_sections.hours.preset_working_hours") %>
          </button>
          <button type="button" class="btn btn-outline w-full text-left justify-start" data-preset="weekend" data-action="click->hours#applyPreset">
            <%= I18n.t("views.places.form_sections.hours.preset_weekend") %>
          </button>
        </div>
      </div>
    </div>

    <div class="mt-6">
      <h3 class="font-semibold text-lg mb-3">
        <%= I18n.t("views.places.form_sections.hours.added_hours") %>
      </h3>
      <div id="hours_list" data-hours-target="hoursList" class="space-y-2 min-h-[2rem]">
        <p id="no_hours_message" class="text-sm text-base-content/60">
          <%= I18n.t("views.places.form_sections.hours.no_hours_added") %>
        </p>
      </div>
    </div>

    <div data-hours-target="hiddenFields"></div>

    <%= render 'places/form_sections/hour_block' %>
  </div>
</fieldset>
