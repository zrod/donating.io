<dialog
  id="location_picker_modal"
  class="modal"
  data-controller="location-picker"
  data-location-picker-protomaps-key-value="<%= ENV['PROTOMAPS_KEY'] %>"
  data-location-picker-poll-interval-value="2000"
  data-location-picker-max-retries-value="10"
  data-location-picker-search-took-too-long-value="<%= I18n.t('views.places.geo_search.search_took_too_long') %>"
  data-location-picker-search-failed-value="<%= I18n.t('views.places.geo_search.search_failed') %>"
  data-location-picker-no-results-found-value="<%= I18n.t('views.places.geo_search.no_results_found') %>"
>
  <div class="modal-box max-w-2xl">
    <h3 class="text-lg font-bold mb-4"><%= I18n.t("views.places.form_sections.location.picker_modal.title") %></h3>

    <div class="flex gap-2 mb-4">
      <input type="text"
             class="input input-bordered flex-1"
             placeholder="<%= I18n.t('views.places.geo_search.placeholder') %>"
             data-location-picker-target="searchInput"
             data-action="keydown.enter->location-picker#search" />
      <button type="button" class="btn btn-primary" data-action="click->location-picker#search" data-location-picker-target="searchButton">
        <%= I18n.t("views.places.geo_search.button") %>
      </button>
    </div>

    <div data-location-picker-target="loading" class="hidden text-center py-4">
      <span class="loading loading-spinner loading-md"></span>
    </div>

    <div data-location-picker-target="error" class="hidden alert alert-error mb-4"></div>

    <div data-location-picker-target="results" class="mb-4 max-h-48 overflow-y-auto border border-base-300 rounded-lg hidden"></div>

    <div class="w-full relative mb-4" style="aspect-ratio: 16/9; background-color: #e5e7eb; border: 1px solid #d1d5db; border-radius: 0.5rem;">
      <div data-location-picker-target="mapContainer"
           class="absolute inset-0"
           style="width: 100%; height: 100%; border-radius: 0.5rem;">
      </div>
      <div data-location-picker-target="mapPlaceholder" class="absolute inset-0 flex items-center justify-center text-base-content/50">
        <%= I18n.t("views.places.form_sections.location.picker_modal.map_placeholder") %>
      </div>
    </div>

    <div class="flex flex-col gap-2">
      <button type="button" class="btn btn-secondary w-full" data-action="click->location-picker#useLocation" data-location-picker-target="useLocationButton" disabled>
        <%= I18n.t("views.places.form_sections.location.picker_modal.use_location") %>
      </button>
      <button type="button" class="btn btn-ghost w-full" data-action="click->location-picker#close">
        <%= I18n.t("views.places.form_sections.location.picker_modal.cancel") %>
      </button>
    </div>
  </div>
  <div class="modal-backdrop" data-action="click->location-picker#close">
    <button type="button">close</button>
  </div>
</dialog>
